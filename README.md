# Analysis-of-the-efficiency-factors-of-the-personnel-reserve

Этот проект предназначен для статистического анализа и выявления ключевых факторов, влияющих на эффективность кадрового резерва в компаниях. Методология основана на применении логистической регрессии с регуляризацией (Elastic-Net) и последующем расчете интегрального влияния каждого фактора.

## Цель проекта
Определить, какие практики и механизмы управления кадровым резервом (например, планирование потребности, оценка кандидатов, развитие) статистически значимо связаны с высокой или низкой бизнес-эффективностью по оценке респондентов.

## Исходные данные
Данные представляют собой анонимные ответы на опросник, содержащий различные вопросы о практиках работы с кадровым резервом. Ключевой целевой показатель:
Оцените эффективность работы вашего кадрового резерва с точки зрения бизнес-эффекта/ вклада в развитие компании по шкале от 0 до 10.

Файл с данными: без лишнего_Россия_Эффективность.xlsx

## Зависимости
Для работы необходимы следующие библиотеки:

Python (скрипты preproc.py, getting_reults.py):

pandas

numpy

scipy

R (скрипт modeling.r):

glmnet

readxl

writexl

dplyr

tibble

Установите зависимости

## Структура проекта и workflow
Процесс анализа строго последователен и состоит из трех этапов:

preproc.py - Предобработка данных и подготовка признаков.

modeling.r - Построение прогнозных моделей с ограничениями.

getting_reults.py - Анализ результатов и расчет интегральных показателей.

1. Preprocessing (preproc.py)
Вход: без лишнего_Россия_Эффективность.xlsx
Выход: X_y для R_plus1.xlsx, X_y для R_minus1.xlsx, X.xlsx

Что делает:

Загружает сырые данные из Excel.

Фильтрует строки с пропусками в ключевых столбцах.

Заменяет ответы "Затрудняюсь ответить" и "Другое" на пропуски (NaN).

Бинаризует целевую переменную y двумя способами:

y_plus1: Высокая эффективность (оценка >= 8)

y_minus1: Низкая эффективность (оценка <= 5)

Преобразует категориальные переменные в бинарные признаки с помощью One-Hot Encoding.

Сохраняет три файла для следующего этапа: матрицу признаков X и две матрицы X_y с разными целевыми переменными.

2. Modeling (modeling.r)
Вход: X_y для R_plus1.xlsx, X_y для R_minus1.xlsx
Выход: coefs_plus1.xlsx, coefs_minus1.xlsx

Что делает:

Загружает данные, подготовленные на этапе preproc.

Вручную задает ограничения на знаки коэффициентов (lower.limits, upper.limits) для логистической регрессии в зависимости от бинаризации:

Для y_plus1 некоторые коэффициенты принудительно >= 0, другие <= 0.

Для y_minus1 ограничения инвертируются.

Обучает модель логистической регрессии с Elastic-Net регуляризацией (alpha=0.5) с использованием кросс-валидации для подбора оптимального параметра lambda.

Извлекает коэффициенты модели при lambda.min (значение λ, дающее наименьшую ошибку) и сохраняет их в отдельные файлы Excel.

3. Getting Results (getting_reults.py)
Вход: coefs_plus1.xlsx, coefs_minus1.xlsx, X.xlsx
Выход: Анализ оценки.xlsx

Что делает:

Загружает коэффициенты двух обученных моделей и матрицу признаков.

Для каждого признака рассчитывает:

Усредненные прогнозы: Вероятность отнесения к классу "Высокая эффективность" (y_plus1) и "Низкая эффективность" (y_minus1) при условии, что признак есть (x=1) и его нет (x=0).

Интегральный показатель: Рассчитывает разность эффектов.
(P(high | x=1) - P(low | x=1)) - (P(high | x=0) - P(low | x=0))
Этот показатель показывает, насколько наличие признака изменяет "баланс" между вероятностью высокой и низкой эффективности.

Проводит бутстрап для оценки устойчивости интегрального показателя (вычисляет стандартное отклонение при многократном случайном сэмплировании подвыборок).

Форматирует результаты (разбивает название признака на "Вопрос" и "Ответ") и сохраняет итоговую таблицу со всеми метриками в файл Анализ оценки.xlsx.

## Как запустить
Подготовьте данные: Убедитесь, что файл без лишнего_Россия_Эффективность.xlsx находится в корневой директории проекта.

Запустите скрипты по порядку:
python preproc.py
Rscript modeling.r
Примечание: Внутри скрипта modeling.r нужно вручную поменять значение переменной rating_binar с -1 на 1 и запустить скрипт дважды, чтобы получить коэффициенты для обеих моделей.
python getting_reults.py
Результаты: Итоговый файл Анализ оценки.xlsx будет содержать таблицу с анализом влияния каждого фактора.

## Интерпретация результатов
В итоговом файле Анализ оценки.xlsx обращайте внимание на следующие столбцы:

Вопрос / Ответ: Конкретная практика или характеристика.

Интегральный показатель: Главная метрика. Положительное значение говорит о том, что наличие этого признака смещает баланс в сторону высокой эффективности. Отрицательное — в сторону низкой.

buts_std (стандартное отклонение бутстрапа): Показывает устойчивость интегрального показателя. Низкое значение (относительно самого показателя) говорит о надежности оценки.

beta-коэффициент_plus1/minus1: Веса из моделей. Показывают направление и силу влияния признака на логит соответствующего класса.
